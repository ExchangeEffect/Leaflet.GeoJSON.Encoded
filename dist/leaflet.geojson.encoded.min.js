(function(){var a=function(a){return a="number"==typeof a?{precision:a}:a||{},a.precision=a.precision||5,a.factor=a.factor||Math.pow(10,a.precision),a.dimension=a.dimension||2,a},b={encode:function(b,c){c=a(c);for(var d=[],e=0,f=b.length;f>e;++e){var g=b[e];if(2===c.dimension)d.push(g.lat||g[0]),d.push(g.lng||g[1]);else for(var h=0;h<c.dimension;++h)d.push(g[h])}return this.encodeDeltas(d,c)},decode:function(b,c){c=a(c);for(var d=this.decodeDeltas(b,c),e=[],f=0,g=d.length;f+(c.dimension-1)<g;){for(var h=[],i=0;i<c.dimension;++i)h.push(d[f++]);e.push(h)}return e},encodeDeltas:function(b,c){c=a(c);for(var d=[],e=0,f=b.length;f>e;)for(var g=0;g<c.dimension;++g,++e){var h=b[e],i=h-(d[g]||0);d[g]=h,b[e]=i}return this.encodeFloats(b,c)},decodeDeltas:function(b,c){c=a(c);for(var d=[],e=this.decodeFloats(b,c),f=0,g=e.length;g>f;)for(var h=0;h<c.dimension;++h,++f)e[f]=Math.round((d[h]=e[f]+(d[h]||0))*c.factor)/c.factor;return e},encodeFloats:function(b,c){c=a(c);for(var d=0,e=b.length;e>d;++d)b[d]=Math.round(b[d]*c.factor);return this.encodeSignedIntegers(b)},decodeFloats:function(b,c){c=a(c);for(var d=this.decodeSignedIntegers(b),e=0,f=d.length;f>e;++e)d[e]/=c.factor;return d},encodeSignedIntegers:function(a){for(var b=0,c=a.length;c>b;++b){var d=a[b];a[b]=0>d?~(d<<1):d<<1}return this.encodeUnsignedIntegers(a)},decodeSignedIntegers:function(a){for(var b=this.decodeUnsignedIntegers(a),c=0,d=b.length;d>c;++c){var e=b[c];b[c]=1&e?~(e>>1):e>>1}return b},encodeUnsignedIntegers:function(a){for(var b="",c=0,d=a.length;d>c;++c)b+=this.encodeUnsignedInteger(a[c]);return b},decodeUnsignedIntegers:function(a){for(var b=[],c=0,d=0,e=0,f=a.length;f>e;++e){var g=a.charCodeAt(e)-63;c|=(31&g)<<d,32>g?(b.push(c),c=0,d=0):d+=5}return b},encodeSignedInteger:function(a){return a=0>a?~(a<<1):a<<1,this.encodeUnsignedInteger(a)},encodeUnsignedInteger:function(a){for(var b,c="";a>=32;)b=(32|31&a)+63,c+=String.fromCharCode(b),a>>=5;return b=a+63,c+=String.fromCharCode(b)}};L.GeoJSON.Encoded=L.GeoJSON.extend({_decodeFeature:function(a){function c(a){for(var c=[],d=0;d<a.length;d++)c.push(b.decode(a[d]));return c}function d(a){for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b}var e,f,g;switch(e=a.geometry.coordinates,a.geometry.type){case"Point":g=L.marker([e[1],e[0]]);break;case"LineString":f=L.Util.isArray(e[0])?L.GeoJSON.coordsToLatLngs(e,0):c(e[0])[0],g=L.polyline(f);break;case"MultiLineString":f=L.Util.isArray(e[0][0])?L.GeoJSON.coordsToLatLngs(e,1):c(e),g=L.multiPolyline(f);break;case"Polygon":f=L.Util.isArray(e[0][0])?L.GeoJSON.coordsToLatLngs(e,1):c(e),g=L.polygon(f);break;case"MultiPolygon":f=L.Util.isArray(e[0][0])?L.GeoJSON.coordsToLatLngs(e,2):d(e),g=L.multiPolygon(f)}return g.toGeoJSON()},addData:function(a){var b,c,d,e=L.Util.isArray(a)?a:a.features;if(e){for(b=0,c=e.length;c>b;b++)d=this._decodeFeature(e[b]),(d.geometries||d.geometry||d.features||d.coordinates)&&this.addData(d);return this}var f=this.options;if(f.filter&&!f.filter(a))return this;var g=L.GeoJSON.geometryToLayer(a,f);return g.feature=L.GeoJSON.asFeature(a),g.defaultOptions=g.options,this.resetStyle(g),f.onEachFeature&&f.onEachFeature(a,g),this.addLayer(g)}}),L.geoJson.encoded=function(a,b){return new L.GeoJSON.Encoded(a,b)}}).call(this);